<!-- student/templates/student/login.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Login — Student</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/student.css') }}">
</head>
<body>
  <div class="login-container">
    <h2>Student Login</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="messages">
          {% for cat, msg in messages %}
            <div class="alert {{cat}}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <div class="tabs">
      <button id="pwTab" class="active">Password</button>
      <button id="otpTab">OTP</button>
    </div>

    <form id="passwordForm" method="post" action="{{ url_for('student_bp.login') }}">
      <input type="hidden" name="mode" value="password">
      <label>Registration Number</label>
      <input name="registration_number" required>
      <label>Password</label>
      <input name="password" type="password" required>
      <button type="submit">Login with Password</button>
      <p><a href="{{ url_for('student_bp.forgot_password') }}">Forgot password?</a></p>
    </form>

    <form id="otpForm" method="post" action="{{ url_for('student_bp.login') }}" style="display:none">
      <input type="hidden" name="mode" value="otp">
      <label>Registration Number</label>
      <input name="registration_number" required>
      <button type="submit">Send OTP</button>
    </form>

    {% if otp_sent %}
      <div class="info">OTP sent to the email of {{ reg_no }} — please check and verify below.</div>
      <form method="post" action="{{ url_for('student_bp.verify_otp') }}">
        <input type="hidden" name="registration_number" value="{{ reg_no }}">
        <label>Enter OTP</label>
        <input name="otp" required>
        <button type="submit">Verify OTP</button>
      </form>
    {% endif %}

  </div>

  <script src="{{ url_for('static', filename='js/student.js') }}"></script>
</body>
</html>
